<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>English Proficiency Test - CBT Platform</title>
  <style>
    :root {
      --primary-color: #0050a4;
      --primary-light: #e6f0fb;
      --secondary-color: #003366;
      --accent-color: #2ecc71;
      --danger-color: #e53935;
      --bg-color: #f5f7fb;
      --card-color: #ffffff;
      --border-color: #dde3f0;
      --text-main: #1f2933;
      --text-muted: #6b7280;
      --transition: all 0.25s ease;
      --radius-lg: 12px;
      --radius-md: 8px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        Roboto, Helvetica, Arial, sans-serif;
    }

    body {
      background: var(--bg-color);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 10px;
      color: var(--text-main);
    }

    .app-shell {
      width: 100%;
      max-width: 1100px;
      background: var(--card-color);
      border-radius: var(--radius-lg);
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      min-height: calc(100vh - 20px);
    }

    /* Top exam bar (TOEFL-style) */
    .top-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      border-bottom: 1px solid var(--border-color);
      background: linear-gradient(to right, #ffffff, #f0f4ff);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #4f8df5, #003366);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ffffff;
      font-weight: 700;
      font-size: 18px;
    }

    .brand-text h1 {
      font-size: 18px;
      font-weight: 600;
      color: var(--secondary-color);
    }

    .brand-text span {
      display: block;
      font-size: 12px;
      color: var(--text-muted);
    }

    .top-right {
      display: flex;
      align-items: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .candidate-name {
      font-size: 13px;
      color: var(--text-muted);
    }

    .candidate-name strong {
      color: var(--text-main);
    }

    .timer-chip {
      padding: 8px 14px;
      border-radius: 999px;
      background: var(--primary-light);
      color: var(--secondary-color);
      font-weight: 600;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border: 1px solid rgba(0, 80, 164, 0.12);
    }

    .timer-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
    }

    /* Main content layout */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 18px;
      gap: 16px;
      background: radial-gradient(circle at top, #eef2ff 0, #f5f7fb 45%);
    }

    /* Welcome screen */
    .welcome-screen {
      margin: auto;
      max-width: 460px;
      background: #ffffff;
      border-radius: var(--radius-lg);
      padding: 24px 20px 26px;
      border: 1px solid var(--border-color);
      box-shadow: 0 14px 30px rgba(15, 23, 42, 0.08);
      animation: fadeInUp 0.5s ease;
    }

    .welcome-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--secondary-color);
      margin-bottom: 6px;
      text-align: center;
    }

    .welcome-subtitle {
      font-size: 13px;
      color: var(--text-muted);
      text-align: center;
      margin-bottom: 16px;
    }

    .divider {
      height: 1px;
      background: var(--border-color);
      margin: 14px 0 18px;
    }

    .welcome-text {
      font-size: 14px;
      color: var(--text-muted);
      line-height: 1.5;
      margin-bottom: 18px;
      text-align: left;
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 6px;
      color: var(--text-main);
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 10px 11px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-color);
      font-size: 14px;
      outline: none;
      transition: var(--transition);
      background: #f9fafb;
    }

    .form-group input:focus,
    .form-group select:focus {
      border-color: var(--primary-color);
      background: #ffffff;
      box-shadow: 0 0 0 2px rgba(0, 80, 164, 0.1);
    }

    .start-btn {
      width: 100%;
      margin-top: 10px;
      padding: 11px;
      border-radius: 999px;
      border: none;
      background: var(--primary-color);
      color: #ffffff;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: var(--transition);
    }

    .start-btn:hover {
      background: #003366;
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0, 51, 102, 0.25);
    }

    /* Test layout */
    .test-area {
      display: none;
      flex: 1;
      min-height: 0;
      animation: fadeIn 0.4s ease;
    }

    .test-header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
      flex-wrap: wrap;
      gap: 8px;
    }

    .section-label {
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--text-muted);
    }

    .question-counter {
      font-size: 13px;
      color: var(--text-muted);
    }

    .progress-container {
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
      margin-bottom: 12px;
    }

    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--primary-color), #3b82f6);
      transition: width 0.3s ease;
    }

    .question-card {
      background: #ffffff;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-color);
      padding: 18px 16px 14px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
      display: flex;
      flex-direction: column;
      gap: 14px;
      min-height: 240px;
    }

    .question-text {
      font-size: 16px;
      font-weight: 500;
      line-height: 1.5;
      color: var(--text-main);
    }

    .options-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 4px;
    }

    @media (max-width: 640px) {
      .options-grid {
        grid-template-columns: 1fr;
      }
    }

    .option-item {
      position: relative;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-color);
      padding: 9px 9px 9px 40px;
      cursor: pointer;
      background: #f9fafb;
      transition: var(--transition);
      min-height: 44px;
      display: flex;
      align-items: center;
      font-size: 14px;
      line-height: 1.4;
    }

    .option-item:hover {
      border-color: #93c5fd;
      background: #eef2ff;
      transform: translateY(-1px);
    }

    .option-item.selected {
      border-color: var(--primary-color);
      background: #e0ecff;
      box-shadow: 0 0 0 1px rgba(0, 80, 164, 0.15);
    }

    .option-badge {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 2px solid #9ca3af;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 700;
      color: #4b5563;
      background: #ffffff;
      transition: var(--transition);
    }

    .option-item.selected .option-badge {
      border-color: var(--primary-color);
      background: var(--primary-color);
      color: #ffffff;
    }

    .option-input {
      position: absolute;
      opacity: 0;
      pointer-events: none;
    }

    /* Sticky bottom navigation bar */
    .nav-bar {
      position: sticky;
      bottom: 0;
      left: 0;
      margin-top: 12px;
      background: rgba(248, 250, 252, 0.96);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(209, 213, 219, 0.7);
      padding: 8px 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .nav-left,
    .nav-right {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .btn {
      border-radius: 999px;
      border: 1px solid var(--border-color);
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 500;
      background: #ffffff;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: var(--transition);
      white-space: nowrap;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .btn-primary {
      background: var(--primary-color);
      color: #ffffff;
      border-color: var(--primary-color);
    }

    .btn-primary:hover:not(:disabled) {
      background: #003366;
      transform: translateY(-1px);
      box-shadow: 0 6px 15px rgba(0, 51, 102, 0.3);
    }

    .btn-secondary:hover:not(:disabled) {
      background: #f3f4f6;
      transform: translateY(-1px);
    }

    .btn-danger {
      background: var(--danger-color);
      color: #ffffff;
      border-color: var(--danger-color);
    }

    .btn-danger:hover:not(:disabled) {
      background: #c62828;
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(198, 40, 40, 0.35);
    }

    .nav-info {
      font-size: 11px;
      color: var(--text-muted);
    }

    /* Result screen */
    .result-screen {
      display: none;
      margin: auto;
      max-width: 480px;
      background: #ffffff;
      border-radius: var(--radius-lg);
      padding: 22px 20px 26px;
      border: 1px solid var(--border-color);
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.18);
      text-align: center;
      animation: fadeInUp 0.5s ease;
    }

    .result-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--secondary-color);
      margin-bottom: 10px;
    }

    .result-subtitle {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 18px;
    }

    .score-circle {
      width: 130px;
      height: 130px;
      border-radius: 50%;
      margin: 0 auto 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: conic-gradient(
        from 0deg,
        var(--primary-color),
        #22c55e,
        #e5e7eb
      );
      position: relative;
      padding: 4px;
    }

    .score-inner {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #ffffff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2px;
    }

    .score-value {
      font-size: 30px;
      font-weight: 700;
      color: var(--secondary-color);
    }

    .score-label {
      font-size: 11px;
      color: var(--text-muted);
    }

    .result-details {
      margin-top: 12px;
      padding: 12px 12px 4px;
      border-radius: var(--radius-md);
      background: #f9fafb;
      border: 1px solid var(--border-color);
      text-align: left;
      font-size: 13px;
    }

    .result-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      color: var(--text-main);
    }

    .result-row span:first-child {
      color: var(--text-muted);
    }

    .result-actions {
      margin-top: 18px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 500;
      background: #e0f2fe;
      color: #0369a1;
      margin-top: 4px;
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(18px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Responsive tweaks */
    @media (max-width: 768px) {
      .app-shell {
        border-radius: 10px;
        min-height: 100vh;
      }

      .top-bar {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }

      .main-content {
        padding: 12px;
      }

      .question-card {
        padding: 14px 12px 12px;
      }

      .nav-bar {
        flex-direction: column;
        align-items: stretch;
      }

      .nav-left,
      .nav-right {
        width: 100%;
        justify-content: space-between;
      }

      .btn {
        flex: 1;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <!-- TOEFL-style top bar -->
    <div class="top-bar">
      <div class="brand">
        <div class="brand-logo">EN</div>
        <div class="brand-text">
          <h1>English Proficiency Test</h1>
          <span>Computer-Based Practice Exam</span>
        </div>
      </div>
      <div class="top-right">
        <div class="candidate-name">
          Candidate: <strong id="candidateNameTop">—</strong>
        </div>
        <div class="timer-chip">
          <span class="timer-dot" id="timerDot"></span>
          <span id="timer">00:00</span>
        </div>
      </div>
    </div>

    <div class="main-content">
      <!-- Welcome Screen -->
      <div id="welcomeScreen" class="welcome-screen">
        <h2 class="welcome-title">Welcome to the English CBT</h2>
        <p class="welcome-subtitle">Please provide your details to begin the test.</p>

        <div class="divider"></div>

        <p class="welcome-text">
          This practice exam evaluates your skills in grammar, vocabulary, sentence structure,
          and reading comprehension. Answer all questions to the best of your ability. Once you
          click <strong>Start Test</strong>, the timer will begin and cannot be paused.
        </p>

        <div class="form-group">
          <label for="studentName">Full Name</label>
          <input type="text" id="studentName" placeholder="Type your full name" />
        </div>

        <div class="form-group">
          <label for="timeSelect">Test Duration &amp; Question Count</label>
          <select id="timeSelect">
            <option value="30">30 minutes — 75 questions</option>
            <option value="60" selected>60 minutes — 150 questions</option>
          </select>
        </div>

        <button id="startBtn" class="start-btn">
          Start Test
        </button>
      </div>

      <!-- Test Area -->
      <div id="testArea" class="test-area">
        <div class="test-header-row">
          <div class="section-label">English Proficiency</div>
          <div class="question-counter" id="questionCounter">Question 1 of 150</div>
        </div>

        <div class="progress-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>

        <div class="question-card">
          <div class="question-text" id="questionText"></div>
          <div class="options-grid" id="optionsContainer"></div>
        </div>

        <div class="nav-bar">
          <div class="nav-left">
            <button id="prevBtn" class="btn btn-secondary">Previous</button>
            <span class="nav-info" id="answeredInfo"></span>
          </div>
          <div class="nav-right">
            <button id="nextBtn" class="btn btn-secondary">Next</button>
            <button id="submitBtn" class="btn btn-danger">Submit Test</button>
          </div>
        </div>
      </div>

      <!-- Result Screen -->
      <div id="resultScreen" class="result-screen">
        <h2 class="result-title">Test Completed</h2>
        <p class="result-subtitle">
          Your performance summary is shown below.
        </p>

        <div class="score-circle">
          <div class="score-inner">
            <div class="score-value" id="scoreDisplay">0%</div>
            <div class="score-label">Overall Score</div>
          </div>
        </div>

        <div class="result-details">
          <div class="result-row">
            <span>Name</span>
            <span id="resultName">—</span>
          </div>
          <div class="result-row">
            <span>Total Questions</span>
            <span id="totalQuestions">0</span>
          </div>
          <div class="result-row">
            <span>Correct Answers</span>
            <span id="correctAnswers">0</span>
          </div>
          <div class="result-row">
            <span>Time Taken</span>
            <span id="timeTaken">0m 0s</span>
          </div>
          <div class="result-row">
            <span>Proficiency</span>
            <span id="proficiencyTag">
              <span class="tag">Calculating…</span>
            </span>
          </div>
        </div>

        <div class="result-actions">
          <button id="restartBtn" class="start-btn">Take Test Again</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- Question generation (demo) ---
    function generateQuestions(count) {
      const questions = [];
      const grammarQuestions = [
        {
          question: "Which sentence is grammatically correct?",
          options: [
            "She don't like apples.",
            "She doesn't like apples.",
            "She doesn't likes apples.",
            "She don't likes apples."
          ],
          correct: 1
        },
        {
          question: "Choose the correct word to complete the sentence: I'm looking forward _____ seeing you.",
          options: ["to", "for", "at", "with"],
          correct: 0
        },
        {
          question: "Identify the correct passive form: They built this house in 1990.",
          options: [
            "This house was built in 1990.",
            "This house is built in 1990.",
            "This house built in 1990.",
            "This house has built in 1990."
          ],
          correct: 0
        },
        {
          question: "Select the correct sentence:",
          options: [
            "Neither of the boys are coming.",
            "Neither of the boys is coming.",
            "Neither of the boys were coming.",
            "Neither of the boys have come."
          ],
          correct: 1
        },
        {
          question: "Choose the correct preposition: I'm good _____ mathematics.",
          options: ["at", "in", "on", "with"],
          correct: 0
        },
        {
          question: "Which sentence uses the correct verb tense?",
          options: [
            "I have seen that movie yesterday.",
            "I saw that movie yesterday.",
            "I see that movie yesterday.",
            "I had seen that movie yesterday."
          ],
          correct: 1
        }
      ];

      const vocabularyQuestions = [
        {
          question: "What is the synonym of 'benevolent'?",
          options: ["Malevolent", "Kind", "Stingy", "Hostile"],
          correct: 1
        },
        {
          question: "What is the meaning of 'ephemeral'?",
          options: ["Eternal", "Temporary", "Important", "Beautiful"],
          correct: 1
        },
        {
          question: "What is the antonym of 'diligent'?",
          options: ["Hardworking", "Lazy", "Careful", "Intelligent"],
          correct: 1
        },
        {
          question: "What does 'ubiquitous' mean?",
          options: ["Rare", "Everywhere", "Expensive", "Ancient"],
          correct: 1
        },
        {
          question: "Which word means 'to make worse'?",
          options: ["Ameliorate", "Aggravate", "Alleviate", "Appreciate"],
          correct: 1
        }
      ];

      const spellingQuestions = [
        {
          question: "Which word is spelled correctly?",
          options: ["Accomodate", "Acommodate", "Accommodate", "Acomodate"],
          correct: 2
        },
        {
          question: "Select the correctly spelled word:",
          options: ["Embarrass", "Embarass", "Embarras", "Embaras"],
          correct: 0
        },
        {
          question: "Which spelling is correct?",
          options: ["Maintenance", "Maintainance", "Maintanance", "Maintenence"],
          correct: 0
        }
      ];

      const readingQuestions = [
        {
          question: "Based on a typical passage, what is the author's main purpose?",
          options: ["To entertain", "To inform", "To persuade", "To describe"],
          correct: 1
        },
        {
          question: "What can usually be inferred from a well-written text?",
          options: [
            "Explicit statements only",
            "Hidden numerical data",
            "Implied information and attitudes",
            "Random unrelated details"
          ],
          correct: 2
        }
      ];

      const allQuestions = [
        ...grammarQuestions,
        ...vocabularyQuestions,
        ...spellingQuestions,
        ...readingQuestions
      ];

      for (let i = 0; i < count; i++) {
        const original = allQuestions[i % allQuestions.length];
        questions.push({
          question: original.question,
          options: [...original.options],
          correct: original.correct
        });
      }

      return questions;
    }

    // --- DOM elements ---
    const welcomeScreen = document.getElementById("welcomeScreen");
    const testArea = document.getElementById("testArea");
    const resultScreen = document.getElementById("resultScreen");

    const startBtn = document.getElementById("startBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const submitBtn = document.getElementById("submitBtn");
    const restartBtn = document.getElementById("restartBtn");

    const timerElement = document.getElementById("timer");
    const timerDot = document.getElementById("timerDot");
    const questionCounter = document.getElementById("questionCounter");
    const answeredInfo = document.getElementById("answeredInfo");
    const questionText = document.getElementById("questionText");
    const optionsContainer = document.getElementById("optionsContainer");
    const progressBar = document.getElementById("progressBar");

    const scoreDisplay = document.getElementById("scoreDisplay");
    const resultName = document.getElementById("resultName");
    const totalQuestions = document.getElementById("totalQuestions");
    const correctAnswers = document.getElementById("correctAnswers");
    const timeTaken = document.getElementById("timeTaken");
    const proficiencyTag = document.getElementById("proficiencyTag");

    const studentNameInput = document.getElementById("studentName");
    const timeSelect = document.getElementById("timeSelect");
    const candidateNameTop = document.getElementById("candidateNameTop");

    // --- Test state ---
    let currentQuestion = 0;
    let userAnswers = [];
    let timer;
    let timeLeft;
    let startTime;
    let endTime;
    let questions = [];

    // Start test
    startBtn.addEventListener("click", startTest);

    function startTest() {
      const studentName = studentNameInput.value.trim();
      if (!studentName) {
        alert("Please enter your full name before starting the test.");
        return;
      }

      candidateNameTop.textContent = studentName;

      const duration = parseInt(timeSelect.value, 10);
      const questionCount = duration === 30 ? 75 : 150;

      questions = generateQuestions(questionCount);
      userAnswers = new Array(questions.length).fill(null);

      timeLeft = duration * 60; // seconds
      startTime = new Date();

      welcomeScreen.style.display = "none";
      resultScreen.style.display = "none";
      testArea.style.display = "block";

      updateQuestionCounter();
      updateAnsweredInfo();
      startTimer();
      displayQuestion();
    }

    // Timer
    function startTimer() {
      updateTimerDisplay();

      timer = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();

        if (timeLeft <= 0) {
          clearInterval(timer);
          alert("Time is up! Your test will be submitted automatically.");
          submitTest();
        }
      }, 1000);
    }

    function updateTimerDisplay() {
      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      timerElement.textContent =
        String(minutes).padStart(2, "0") +
        ":" +
        String(seconds).padStart(2, "0");

      if (timeLeft <= 300) {
        timerElement.style.color = "#e53935";
        timerDot.style.backgroundColor = "#e53935";
      } else {
        timerElement.style.color = "#003366";
        timerDot.style.backgroundColor = "#22c55e";
      }
    }

    // Display question
    function displayQuestion() {
      const q = questions[currentQuestion];
      questionText.textContent = q.question;

      optionsContainer.innerHTML = "";
      q.options.forEach((opt, index) => {
        const optionDiv = document.createElement("div");
        optionDiv.className = "option-item";
        if (userAnswers[currentQuestion] === index) {
          optionDiv.classList.add("selected");
        }

        optionDiv.innerHTML = `
          <input class="option-input" type="radio" name="option" id="opt${index}" value="${index}" />
          <div class="option-badge">${String.fromCharCode(65 + index)}</div>
          <div>${opt}</div>
        `;

        optionDiv.addEventListener("click", () => selectOption(index));
        optionsContainer.appendChild(optionDiv);
      });

      updateQuestionCounter();
      updateProgressBar();
      updateAnsweredInfo();

      prevBtn.disabled = currentQuestion === 0;
      nextBtn.disabled = currentQuestion === questions.length - 1;
    }

    function updateQuestionCounter() {
      questionCounter.textContent = `Question ${currentQuestion + 1} of ${
        questions.length
      }`;
    }

    function updateProgressBar() {
      const progress = ((currentQuestion + 1) / questions.length) * 100;
      progressBar.style.width = `${progress}%`;
    }

    function updateAnsweredInfo() {
      const answeredCount = userAnswers.filter((a) => a !== null).length;
      answeredInfo.textContent = `${answeredCount} of ${questions.length} answered`;
    }

    // Select option
    function selectOption(index) {
      userAnswers[currentQuestion] = index;
      const options = optionsContainer.querySelectorAll(".option-item");
      options.forEach((opt) => opt.classList.remove("selected"));
      options[index].classList.add("selected");
      updateAnsweredInfo();
    }

    // Navigation
    prevBtn.addEventListener("click", () => {
      if (currentQuestion > 0) {
        currentQuestion--;
        displayQuestion();
      }
    });

    nextBtn.addEventListener("click", () => {
      if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        displayQuestion();
      }
    });

    submitBtn.addEventListener("click", () => {
      const confirmSubmit = confirm(
        "Are you sure you want to submit your test now?"
      );
      if (confirmSubmit) {
        submitTest();
      }
    });

    function submitTest() {
      clearInterval(timer);
      endTime = new Date();

      let correctCount = 0;
      userAnswers.forEach((answer, i) => {
        if (answer === questions[i].correct) {
          correctCount++;
        }
      });

      const scorePercent = (correctCount / questions.length) * 100;

      const diffSeconds = Math.floor((endTime - startTime) / 1000);
      const minutesTaken = Math.floor(diffSeconds / 60);
      const secondsTaken = diffSeconds % 60;

      testArea.style.display = "none";
      resultScreen.style.display = "block";

      resultName.textContent = studentNameInput.value.trim();
      totalQuestions.textContent = questions.length;
      correctAnswers.textContent = correctCount;
      timeTaken.textContent = `${minutesTaken}m ${secondsTaken}s`;

      animateScore(Math.round(scorePercent));
      setProficiency(scorePercent);
    }

    function animateScore(target) {
      let current = 0;
      const interval = setInterval(() => {
        current++;
        scoreDisplay.textContent = current + "%";
        if (current >= target) {
          clearInterval(interval);
        }
      }, 20);
    }

    function setProficiency(score) {
      let label = "";
      let bg = "";
      let color = "";

      if (score >= 85) {
        label = "Highly Proficient";
        bg = "#dcfce7";
        color = "#166534";
      } else if (score >= 70) {
        label = "Proficient";
        bg = "#e0f2fe";
        color = "#0369a1";
      } else if (score >= 60) {
        label = "Fairly Proficient";
        bg = "#fef9c3";
        color = "#854d0e";
      } else if (score >= 50) {
        label = "Scarcely Proficient";
        bg = "#fee2e2";
        color = "#b91c1c";
      } else {
        label = "Not Proficient";
        bg = "#fee2e2";
        color = "#b91c1c";
      }

      proficiencyTag.innerHTML = `<span class="tag" style="background:${bg}; color:${color};">${label}</span>`;
    }

    restartBtn.addEventListener("click", () => {
      currentQuestion = 0;
      userAnswers = [];
      studentNameInput.value = "";
      timeSelect.value = "60";
      timerElement.textContent = "00:00";
      candidateNameTop.textContent = "—";
      timerElement.style.color = "#003366";
      timerDot.style.backgroundColor = "#22c55e";

      resultScreen.style.display = "none";
      welcomeScreen.style.display = "block";
    });
  </script>
</body>
</html>
